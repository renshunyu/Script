set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;
 
insert into  aiiap.iap_app_log_operate_day PARTITION(operate_day)
SELECT   t.log_id,
         t.domain_id,
         t.person_name,
         ma.area_id,
         ma.area_name,
         t.person_org_id,
         t.person_org_name,
         t.person_status_id,
         t.person_status,
         t.main_acct_id,
         t.main_acct_name,
         t.main_acct_status_id,
         t.main_acct_status,
         t.sub_acct_id,
         t.sub_acct_name,
         t.sub_acct_status_id,
         t.sub_acct_status,
         t.sub_acct_type_id,
         t.sub_acct_type_name,
         t.sub_acct_org_id,
         t.sub_acct_org_name,
         t.client_name,
         t.client_ip,
         t.client_mac,
         t.client_cpu_serial,
         t.client_area_id,
         t.client_area_name,
         t.client_ip_section_id,
         t.client_ip_section_name,
         t.server_ip_section_id,
         t.server_ip_section_name,
         t.server_ip,
         t.audit_type_id,
         t.audit_type_name,
         t.audit_level_id,
         t.audit_level_name,
         t.operate_type_id,
         t.operate_type_name,
         t.operate_content,
         t.operate_result,
         t.operate_time,
         t.task_no,
         t.create_time,
         t.is_work_time,
         t.is_work_day,
         t.module_id,
         t.module_name,
         t.obj_type_id,
         t.obj_type_name,
         t.person_duty_id,
         t.person_duty_name,
         t.action_type_id,
         t.action_type_name,
         t.bank_proof,
         t.client_network_address,
         t.bank_approve,
         t.log_source,
         t.is_author_others,
         t.own_main_acct_id,
         t.own_main_acct_name,
         t.own_person_name,
         t.bankflag,
         t.bank_isneed,
         t.isbinding,
         t.from_provinces_id,
         t.from_provinces_name,
         t.to_provinces_id,
         t.to_provinces_name,
         t.gold_appr_main_acct_id,
         t.gold_appr_person_name,
         t.bank_isopen,
         t.bank_scene_id,
         t.bank_scene_name,
         t.bank_apply_type,
         t.bank_last_check_status,
         t.bank_last_check_time,
         t.bank_faied_check_count,
         t.operate_object_type,
         t.audit_sub_type_id,
         t.audit_sub_type_name,
         t.is_login_byfoura,
         t.round_type,
         t.import_time,
         t.level2_org_id,
         t.level2_org_name,
         t.std_create_time,
         t.std_begin_time,
         t.ori_create_time,
         t.ori_file_name,
         t.ori_file_rownum,
         t.ori_gather_time,
         t.recheck_data_id,
         t.app_maintainer_id,
         t.app_maintainer,
         t.app_import_level,
         t.acct_type,
         t.remark,
         t.effect_time,
         t.expire_time,
         t.acct_type_name,
         t.role_id,
         t.op_obj,
         t.client_bois_serial,
         t.hard_disk_serial,
         t.retain1,
         t.retain2,
         t.retain3,
         t.retain4,
         t.retain5,
         t.retain6,
         t.retain7,
         t.retain8,
         t.retain9,
         t.retain10,
         t.operate_day
  FROM   (select * from aiiaptestc.iap_app_log_operate_day where operate_day like '2017-07%' and domain_id = 'UAP') t
    left join (select m.main_acct_id, m.area_id, a.area_name
                 from uap_main_acct m
                 left join uap_area a on m.area_id = a.area_id) ma on t.main_acct_id =
                                                                      ma.main_acct_id;